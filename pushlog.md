# 3.26

## 上传前端的环境配置

### by 沈刘

### ------------------------------------------

# 3.27 晚

## 任务完成情况：

### 完成登录注册页面。

## 关系设计说明：

### 学号/工号是用户身份唯一标识，而不是用户名。邮箱也不能重复。

## 安全措施：

### 密码已经加密，在 admin 后台只能看到加密后的用户密码（一堆乱码）

### 在.html 文件中加入了{%csrf_token%} 可以防止“跨站请求伪造”

## 待完善的地方：

### 前端：注册和登录页面需要美化。页面上方的导航栏出了点问题。

### 后端：将教师/学生的注册和登录页面分开。

### 设计表格：数据库里要增加 2 张表格：当前预定状态的表格和图书馆 座位情况的表格。

### by 陈欣然

### ------------------------------------------

# 3.28 中午

## 任务完成情况：修复部分无法显示的 bug

### by 沈刘

### ------------------------------------------

# 4.1 中午

## 任务完成情况:

### 完成前端基本界面框架的搭建包括 查询信息、预约座位、续约座位、取消预约 四个模块的初始化工作，具体的实现部分还未完成

### 打开./front/dist/index.html 文件即可查看预览图

### 或者直接用 django 运行项目，在登陆成功后可以查看到预览图，效果图的截图请看 效果图 1.png 和效果图 2.png

### 效果图中两侧有白边框，在以后的更新中解决

### 添加前端的验证

### by 沈刘

### ------------------------------------------

# 4.10 傍晚

## 任务完成情况：

1. 将郑幸锴同学设计的数据库整合到项目中
2. 新建了测试数据文件，详情见 测试数据生成集 文件夹下的 readme.md 文件
3. 整理项目的文档
4. 注意：如果要添加本次更新的新的数据库，需要进行一下操作：删除重新创建 mysql 中的 users 模式，然后删除 \rear\login\migrations 目录下的 除了**init**.py 以外的所有文件，在终端运行一下命令
   ```
   python manage.py makemigrations  #准备迁移
   python manage.py migrate         #数据库迁移
   python manage.py createsuperuser #创建超级用户
   ```
   运行完毕后打开 “测试数据生成集” 文件夹，生成测试数据，然后就可以运行整个项目

#### by 沈刘

# 4.13 晚 -4.14 早

## 任务完成情况：

### 1.在原有基础上修改数据库模型。将 desk 和 rent 放入新的 app 文件夹下。并增加了 floor 类。

## 数据库说明：

### 两个 App 使用的是同一个数据库。

## 尚待讨论商榷的问题：

### 一些外键的使用、约束关系的设置。

### 2.在原有基础上修改测试数据生成文件。生成了 user,desk,floor 类的数据。生成方法同上。

## 说明：

### （1）floor 类有 4 层，每层的最大容量是 25（可以更改）。

### （2）desk 的 id 是它的主码。1-25 号放第一层，26-50 放第二层，以此类推……

### （3）把 Mysqldb 修改未 pymysql。

### MySQLdb 试用于较早期版本，而 pymysql 是新版本。

### 3.尝试写了查询的 view 函数和 base 模板。

### 函数的逻辑可供参考，但需要做一些调整。

## 存在的问题：

### 没有跑通这一部分。希望得到关于 API 实现部分的帮助。

## 说明：

### view.py 调用了一个@api_view ，这里使用了一个叫做 rest-frame 的框架。需要通过 pip install django-rest-swagger 安装

### 安装只需要几秒钟时间。django 版本是 2.0.6.

## 下一步任务：分工写 API 接口

### by 陈欣然

### ------------------------------------------

# 4.15 下午

## 任务完成情况

### 完成 search 接口的开发，search 部分的接口文档如下，前端的同学如果有时间可以尝试写一下

|  实现功能   | 查询图书馆的空位情况 |
|  ----  | ----  |
| 请求体  | http://127.0.0.1:8000/seat/search?No=1 |
| 请求方式  | GET |
| 请求参数  | No (用户账号) |
| 返回格式  | JSON |
| 返回体格式| {status:0;(0代表操作成功且用户已经有了预约记录，1代表操作成功但用户没有预约记录，2代表操作失败) message:[{ desk_number:001 , floor:1},{desk_number:001 , floor:1}];（返回所有的空位信息）rent:{id,user_number_id,desk_number_id,date,start_time,end_time,operate_time,status}（如果有预约记录，返回用户的预约记录，如果没有，返回空值）}|

### 具体实现效果在文件夹 预览图 中可以看到
### 如果数据库有变化可能接口有所变化
### by 沈刘
### ------------------------------------------
### ------------------------------------------

# 4.19 下午

## 任务完成情况

### 完成 rent 接口的开发，修改了部分model的内容
### 如果数据库有变化可能接口有所变化
### by 郑幸锴
### ------------------------------------------

# 4.19 晚上

## 任务完成情况

## 完成 cancel 接口的开发 （view.py）

## 在views.py 注释掉了原来写的get_all_user，看起来应该用不到。rest-frame 框架也用不到了。

## 我在测试数据生成中加入了一个cancel.sql文件，根据姓名，实现某个元组的删除。

### by 陈欣然

### 问题：cancel后端接口还没有和前端相连接，无法验证设计是否完善合理

### --------------------------------------------------

# 4.20晚上

## 任务完成情况

## 完成query reserve 前端界面的开发

## query中还缺少一个v-if判断部分，需要讨论；两个url还有一些问题；因为我是用`npm run dev`编写的，所以还需要跟后端结合验证是否有错。

### by 顾睿

### -----------------------------------

# 4.20 晚

## 任务完成情况

## 早上的情况说明：我后续查询了官方文件，官方给出的python3.8并不适配django2.2.8以下的版本，考虑是降python版本或适当更新django的版本。

## 根据接口文件文件完成renew接口的开发，缺少与前端相连，无法确定合理完善。

## 后续应该还需要继续完善修改。

### by 王玮

### --------------------------------------------------------------

# 4.20 晚

## 任务完成情况

## 在沈刘同学的提醒下，1、model.Rent.objects.creat()中有外键无法插入，取消插入操作，使用updata进行修改end_time。2、由于取消操作存在，进行recordsearch时无法排除取消预约的情况，在查询条件中加入state=0的条件。

## 逻辑还需要进一步完善

### by 王玮

### -----------

# 4.21 晚

## 任务完成情况

## 利用css的bootstrap模板将前端查询界面查询得到的信息以表格形式呈现

### by 顾睿

### --------------------

# 5.1

## 任务完成情况

利用element-ui实现了query界面和reserve界面的部分美化；实现了电影院选座的效果布局；利用el-date-picker美化了预约界面表单；利用el-calendar美化了reserve界面

仍需要解决的问题：

1. query界面搜索功能未实现；根据查询结果换颜色功能仍然不太了解实现原理
2. reserve部分，el-calendar的效果和query部分的el-icon的效果我这边本地都加载不出来，可能因为element-ui的配置问题。
3. 希望通过导入背景图片美化界面

by 顾睿

--------------------

